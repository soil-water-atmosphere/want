# drawing circles and xy-ellipses along 


unit.circle.x = c(1 ,0.987051 ,0.9485395 ,0.8854626 ,
                 0.7994542 ,0.6927415 ,0.5680882 ,0.4287226 ,
                 0.278254 ,0.1205791 ,-0.04021846 ,-0.1999745 ,
                 -0.3545516 ,-0.4999465 ,-0.6323938 ,-0.7484635 ,
                 -0.8451495 ,-0.9199478 ,-0.9709213 ,-0.99675 ,
                 -0.996765 ,-0.9709657 ,-0.9200204 ,-0.8452485 ,
                 -0.7485864 ,-0.6325374 ,-0.500107 ,-0.3547248 ,
                 -0.200156 ,-0.04040362 ,0.1203952 ,0.278076 ,
                 0.4285552 ,0.5679357 ,0.6926078 ,0.7993428 ,
                 0.8853765 ,0.9484808 ,0.9870213 ,1)

unit.circle.y = c(0 ,0.1604066 ,0.316659 ,0.4647106 ,
                  0.6007271 ,0.721186 ,0.8229677 ,0.9034362 ,
                  0.9605075 ,0.9927037 ,0.9991909 ,0.9798011 ,
                  0.9350365 ,0.8660563 ,0.774647 ,0.663176 ,
                  0.5345301 ,0.3920409 ,0.2393987 ,0.08055655 ,
                  -0.08037185 ,-0.2392188 ,-0.3918704 ,-0.5343735 ,
                  -0.6630373 ,-0.7745298 ,-0.8659636 ,-0.9349707 ,
                  -0.979764 ,-0.9991834 ,-0.992726 ,-0.9605591 ,
                  -0.9035156 ,-0.8230729 ,-0.7213143 ,-0.6008752 ,
                  -0.4648746 ,-0.3168347 ,-0.1605895 ,-0.0001853072)

draw.circle = function(centerx,centery,r, ...)
{
  polygon(centerx+r*unit.circle.x,centery+r*unit.circle.y,...)
}

draw.xyellipse  = function(centerx,centery,rx,ry,...)
{
  polygon(centerx+rx*unit.circle.x,centery+ry*unit.circle.y,...)
}

# default fill colors 

deffillcolors = c(
  rgb(255,255,255,maxColorValue=255),
  rgb(252,254,255,maxColorValue=255),
  rgb(250,253,255,maxColorValue=255),
  rgb(247,252,254,maxColorValue=255),
  rgb(244,251,254,maxColorValue=255),
  rgb(242,250,254,maxColorValue=255),
  rgb(239,249,254,maxColorValue=255),
  rgb(236,248,253,maxColorValue=255),
  rgb(234,247,253,maxColorValue=255),
  rgb(231,246,253,maxColorValue=255),
  rgb(229,245,253,maxColorValue=255),
  rgb(226,244,253,maxColorValue=255),
  rgb(223,243,252,maxColorValue=255),
  rgb(221,242,252,maxColorValue=255),
  rgb(218,241,252,maxColorValue=255),
  rgb(215,240,252,maxColorValue=255),
  rgb(213,239,252,maxColorValue=255),
  rgb(210,238,251,maxColorValue=255),
  rgb(207,237,251,maxColorValue=255),
  rgb(205,236,251,maxColorValue=255),
  rgb(202,235,251,maxColorValue=255),
  rgb(199,234,250,maxColorValue=255),
  rgb(197,233,250,maxColorValue=255),
  rgb(194,232,250,maxColorValue=255),
  rgb(191,231,250,maxColorValue=255),
  rgb(189,230,250,maxColorValue=255),
  rgb(186,229,249,maxColorValue=255),
  rgb(183,228,249,maxColorValue=255),
  rgb(181,227,249,maxColorValue=255),
  rgb(178,226,249,maxColorValue=255),
  rgb(176,225,249,maxColorValue=255),
  rgb(173,224,248,maxColorValue=255),
  rgb(170,223,248,maxColorValue=255),
  rgb(168,222,248,maxColorValue=255),
  rgb(165,221,248,maxColorValue=255),
  rgb(162,220,247,maxColorValue=255),
  rgb(157,218,247,maxColorValue=255),
  rgb(155,216,246,maxColorValue=255),
  rgb(152,214,245,maxColorValue=255),
  rgb(150,212,243,maxColorValue=255),
  rgb(148,210,242,maxColorValue=255),
  rgb(146,208,241,maxColorValue=255),
  rgb(143,206,240,maxColorValue=255),
  rgb(141,204,238,maxColorValue=255),
  rgb(139,202,237,maxColorValue=255),
  rgb(136,200,236,maxColorValue=255),
  rgb(134,197,235,maxColorValue=255),
  rgb(132,195,234,maxColorValue=255),
  rgb(129,193,232,maxColorValue=255),
  rgb(127,191,231,maxColorValue=255),
  rgb(125,189,230,maxColorValue=255),
  rgb(123,187,229,maxColorValue=255),
  rgb(120,185,228,maxColorValue=255),
  rgb(118,183,226,maxColorValue=255),
  rgb(116,181,225,maxColorValue=255),
  rgb(113,179,224,maxColorValue=255),
  rgb(111,177,223,maxColorValue=255),
  rgb(109,175,221,maxColorValue=255),
  rgb(106,173,220,maxColorValue=255),
  rgb(104,171,219,maxColorValue=255),
  rgb(102,169,218,maxColorValue=255),
  rgb(100,167,217,maxColorValue=255),
  rgb(97,165,215,maxColorValue=255) ,
  rgb(95,163,214,maxColorValue=255) ,
  rgb(93,160,213,maxColorValue=255) ,
  rgb(90,158,212,maxColorValue=255) ,
  rgb(88,156,211,maxColorValue=255) ,
  rgb(86,154,209,maxColorValue=255) ,
  rgb(83,152,208,maxColorValue=255) ,
  rgb(81,150,207,maxColorValue=255) ,
  rgb(79,148,206,maxColorValue=255) ,
  rgb(77,146,204,maxColorValue=255) ,
  rgb(72,142,202,maxColorValue=255) ,
  rgb(72,143,198,maxColorValue=255) ,
  rgb(72,144,195,maxColorValue=255) ,
  rgb(72,145,191,maxColorValue=255) ,
  rgb(72,146,188,maxColorValue=255) ,
  rgb(72,147,184,maxColorValue=255) ,
  rgb(72,148,181,maxColorValue=255) ,
  rgb(72,149,177,maxColorValue=255) ,
  rgb(72,150,173,maxColorValue=255) ,
  rgb(72,151,170,maxColorValue=255) ,
  rgb(72,153,166,maxColorValue=255) ,
  rgb(72,154,163,maxColorValue=255) ,
  rgb(72,155,159,maxColorValue=255) ,
  rgb(72,156,156,maxColorValue=255) ,
  rgb(72,157,152,maxColorValue=255) ,
  rgb(72,158,148,maxColorValue=255) ,
  rgb(72,159,145,maxColorValue=255) ,
  rgb(72,160,141,maxColorValue=255) ,
  rgb(72,161,138,maxColorValue=255) ,
  rgb(73,162,134,maxColorValue=255) ,
  rgb(73,163,131,maxColorValue=255) ,
  rgb(73,164,127,maxColorValue=255) ,
  rgb(73,165,124,maxColorValue=255),
  rgb(73,166,120,maxColorValue=255),
  rgb(73,167,116,maxColorValue=255),
  rgb(73,168,113,maxColorValue=255),
  rgb(73,169,109,maxColorValue=255),
  rgb(73,170,106,maxColorValue=255),
  rgb(73,172,102,maxColorValue=255),
  rgb(73,173,99,maxColorValue=255) ,
  rgb(73,174,95,maxColorValue=255) ,
  rgb(73,175,91,maxColorValue=255) ,
  rgb(73,176,88,maxColorValue=255) ,
  rgb(73,177,84,maxColorValue=255) ,
  rgb(73,178,81,maxColorValue=255) ,
  rgb(73,179,77,maxColorValue=255) ,
  rgb(73,181,70,maxColorValue=255) ,
  rgb(78,182,71,maxColorValue=255) ,
  rgb(83,184,71,maxColorValue=255) ,
  rgb(87,185,72,maxColorValue=255) ,
  rgb(92,187,72,maxColorValue=255) ,
  rgb(97,188,73,maxColorValue=255) ,
  rgb(102,189,74,maxColorValue=255),
  rgb(106,191,74,maxColorValue=255),
  rgb(111,192,75,maxColorValue=255),
  rgb(116,193,75,maxColorValue=255),
  rgb(121,195,76,maxColorValue=255),
  rgb(126,196,77,maxColorValue=255),
  rgb(130,198,77,maxColorValue=255),
  rgb(135,199,78,maxColorValue=255),
  rgb(140,200,78,maxColorValue=255),
  rgb(145,202,79,maxColorValue=255),
  rgb(150,203,80,maxColorValue=255),
  rgb(154,204,80,maxColorValue=255),
  rgb(159,206,81,maxColorValue=255),
  rgb(164,207,81,maxColorValue=255),
  rgb(169,209,82,maxColorValue=255),
  rgb(173,210,82,maxColorValue=255),
  rgb(178,211,83,maxColorValue=255),
  rgb(183,213,84,maxColorValue=255),
  rgb(188,214,84,maxColorValue=255),
  rgb(193,215,85,maxColorValue=255),
  rgb(197,217,85,maxColorValue=255),
  rgb(202,218,86,maxColorValue=255),
  rgb(207,220,87,maxColorValue=255),
  rgb(212,221,87,maxColorValue=255),
  rgb(217,222,88,maxColorValue=255),
  rgb(221,224,88,maxColorValue=255),
  rgb(226,225,89,maxColorValue=255),
  rgb(231,226,90,maxColorValue=255),
  rgb(236,228,90,maxColorValue=255),
  rgb(240,229,91,maxColorValue=255),
  rgb(245,231,91,maxColorValue=255),
  rgb(250,232,92,maxColorValue=255),
  rgb(250,229,91,maxColorValue=255),
  rgb(250,225,89,maxColorValue=255),
  rgb(250,222,88,maxColorValue=255),
  rgb(249,218,86,maxColorValue=255),
  rgb(249,215,85,maxColorValue=255),
  rgb(249,212,84,maxColorValue=255),
  rgb(249,208,82,maxColorValue=255),
  rgb(249,205,81,maxColorValue=255),
  rgb(249,201,80,maxColorValue=255),
  rgb(249,198,78,maxColorValue=255),
  rgb(249,195,77,maxColorValue=255),
  rgb(248,191,75,maxColorValue=255),
  rgb(248,188,74,maxColorValue=255),
  rgb(248,184,73,maxColorValue=255),
  rgb(248,181,71,maxColorValue=255),
  rgb(248,178,70,maxColorValue=255),
  rgb(248,174,69,maxColorValue=255),
  rgb(248,171,67,maxColorValue=255),
  rgb(247,167,66,maxColorValue=255),
  rgb(247,164,64,maxColorValue=255),
  rgb(247,160,63,maxColorValue=255),
  rgb(247,157,62,maxColorValue=255),
  rgb(247,154,60,maxColorValue=255),
  rgb(247,150,59,maxColorValue=255),
  rgb(247,147,58,maxColorValue=255),
  rgb(246,143,56,maxColorValue=255),
  rgb(246,140,55,maxColorValue=255),
  rgb(246,137,53,maxColorValue=255),
  rgb(246,133,52,maxColorValue=255),
  rgb(246,130,51,maxColorValue=255),
  rgb(246,126,49,maxColorValue=255),
  rgb(246,123,48,maxColorValue=255),
  rgb(246,120,47,maxColorValue=255),
  rgb(245,116,45,maxColorValue=255),
  rgb(245,113,44,maxColorValue=255),
  rgb(245,106,41,maxColorValue=255),
  rgb(244,104,41,maxColorValue=255),
  rgb(243,102,41,maxColorValue=255),
  rgb(242,100,41,maxColorValue=255),
  rgb(241,98,41,maxColorValue=255) ,
  rgb(240,96,41,maxColorValue=255) ,
  rgb(239,94,41,maxColorValue=255) ,
  rgb(239,92,41,maxColorValue=255),
  rgb(238,90,41,maxColorValue=255),
  rgb(237,88,41,maxColorValue=255),
  rgb(236,86,41,maxColorValue=255),
  rgb(235,84,41,maxColorValue=255),
  rgb(234,82,41,maxColorValue=255),
  rgb(233,80,41,maxColorValue=255),
  rgb(232,78,41,maxColorValue=255),
  rgb(231,76,41,maxColorValue=255),
  rgb(230,74,41,maxColorValue=255),
  rgb(229,72,41,maxColorValue=255),
  rgb(228,70,41,maxColorValue=255),
  rgb(228,67,40,maxColorValue=255),
  rgb(227,65,40,maxColorValue=255),
  rgb(226,63,40,maxColorValue=255),
  rgb(225,61,40,maxColorValue=255),
  rgb(224,59,40,maxColorValue=255),
  rgb(223,57,40,maxColorValue=255),
  rgb(222,55,40,maxColorValue=255),
  rgb(221,53,40,maxColorValue=255),
  rgb(220,51,40,maxColorValue=255),
  rgb(219,49,40,maxColorValue=255),
  rgb(218,47,40,maxColorValue=255),
  rgb(217,45,40,maxColorValue=255),
  rgb(217,43,40,maxColorValue=255),
  rgb(216,41,40,maxColorValue=255),
  rgb(215,39,40,maxColorValue=255),
  rgb(214,37,40,maxColorValue=255),
  rgb(213,35,40,maxColorValue=255),
  rgb(211,31,40,maxColorValue=255),
  rgb(209,31,40,maxColorValue=255),
  rgb(207,30,39,maxColorValue=255),
  rgb(206,30,39,maxColorValue=255),
  rgb(204,30,38,maxColorValue=255),
  rgb(202,30,38,maxColorValue=255),
  rgb(200,29,38,maxColorValue=255),
  rgb(199,29,37,maxColorValue=255),
  rgb(197,29,37,maxColorValue=255),
  rgb(195,29,36,maxColorValue=255),
  rgb(193,28,36,maxColorValue=255),
  rgb(192,28,36,maxColorValue=255),
  rgb(190,28,35,maxColorValue=255),
  rgb(188,27,35,maxColorValue=255),
  rgb(186,27,34,maxColorValue=255),
  rgb(185,27,34,maxColorValue=255),
  rgb(183,27,34,maxColorValue=255),
  rgb(181,26,33,maxColorValue=255),
  rgb(179,26,33,maxColorValue=255),
  rgb(178,26,32,maxColorValue=255),
  rgb(176,26,32,maxColorValue=255),
  rgb(174,25,31,maxColorValue=255),
  rgb(172,25,31,maxColorValue=255),
  rgb(171,25,31,maxColorValue=255),
  rgb(169,25,30,maxColorValue=255),
  rgb(167,24,30,maxColorValue=255),
  rgb(165,24,29,maxColorValue=255),
  rgb(164,24,29,maxColorValue=255),
  rgb(162,23,29,maxColorValue=255),
  rgb(160,23,28,maxColorValue=255),
  rgb(158,23,28,maxColorValue=255),
  rgb(157,23,27,maxColorValue=255),
  rgb(155,22,27,maxColorValue=255),
  rgb(153,22,27,maxColorValue=255),
  rgb(151,22,26,maxColorValue=255),
  rgb(150,22,26,maxColorValue=255),
  rgb(146,21,25,maxColorValue=255))

# my arrow drawer


Arrows <- function(x0, y0, x1, y1,angle=10,length=0.2,lwd = 1)  
{
  usr = par("usr")
  pin = par("pin")
  screenlength = ((x1-x0)/(usr[2]-usr[1])*pin[1])^2+
    ((y1-y0)/(usr[4]-usr[3])*pin[2])^2
  I = (screenlength>1e-3)
  arrows(x0[I],y0[I],x1[I],y1[I],code=2,angle=angle,length=length,lwd=lwd)
}

